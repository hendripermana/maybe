<%# locals: (form:) %>
<div class="p-3" data-controller="list-filter">
  <div class="relative mb-4">
    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.3-4.3"></path>
      </svg>
    </div>
    <input type="search" 
           autocomplete="off" 
           placeholder="Filter category" 
           data-list-filter-target="input" 
           data-action="input->list-filter#filter" 
           class="flex h-10 w-full rounded-md border border-input bg-background pl-10 pr-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
  </div>
  
  <div class="space-y-1 max-h-60 overflow-y-auto" id="list" data-list-filter-target="list">
    <% family_categories.each do |category| %>
      <div class="filterable-item flex items-center gap-2 p-2 rounded-md hover:bg-accent" data-filter-name="<%= category.name %>">
        <div class="flex items-center space-x-2">
          <input type="checkbox" 
                 id="category_<%= category.id %>" 
                 name="q[categories][]" 
                 value="<%= category.name %>" 
                 <%= 'checked' if @q[:categories]&.include?(category.name) %>
                 class="h-4 w-4 rounded border-input bg-background text-primary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2">
          <label for="category_<%= category.id %>" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer">
            <%= render partial: "categories/badge", locals: { category: category } %>
          </label>
        </div>
      </div>
    <% end %>
  </div>
</div>
