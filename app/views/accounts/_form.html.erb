<%# locals: (account:, url:) %>

<% if @error_message.present? %>
  <%= render AlertComponent.new(message: @error_message, variant: :error) %>
<% end %>

<%= styled_form_with model: account, url: url, scope: :account, data: { turbo: false }, class: "flex flex-col gap-4 justify-between grow text-primary" do |form| %>
  <div class="grow space-y-2">
    <%= form.hidden_field :accountable_type %>
    <%= form.hidden_field :return_to, value: params[:return_to] %>

    <%= form.text_field :name, placeholder: t(".name_placeholder"), required: "required", label: t(".name_label") %>

    <% unless account.linked? %>
      <%= form.money_field :balance, label: t(".balance"), required: true, default_currency: Current.family.currency %>
    <% end %>

    <%= yield form %>

    <%# Brankas Integration Option %>
    <div class="border-t pt-4 mt-4">
      <p class="text-sm text-gray-600 mb-3">Or connect your Indonesian bank account automatically:</p>
      <%= button_to "#", 
                    data: { controller: "brankas-link" },
                    class: "w-full text-primary flex items-center justify-center gap-3 focus:outline-hidden bg-green-50 border border-green-200 hover:bg-green-100 rounded-lg p-3",
                    form: { class: "w-full" } do %>
        <span class="flex w-6 h-6 items-center justify-center rounded bg-green-100">
          <%= icon("link-2") %>
        </span>
        Connect Indonesian Bank (Brankas)
      <% end %>
    </div>
  </div>

  <%= form.submit %>
<% end %>
